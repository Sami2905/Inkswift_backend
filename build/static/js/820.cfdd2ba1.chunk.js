"use strict";(self.webpackChunkdoc_sign_client=self.webpackChunkdoc_sign_client||[]).push([[820],{1820:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var s=a(5043),i=a(3216),n=a(9798),l=a(8072),d=a(4122),c=a(579);const o=()=>{const{token:e}=(0,i.g)(),[t,a]=(0,s.useState)(!0),[o,r]=(0,s.useState)(null),[u,m]=(0,s.useState)(null),[g,h]=(0,s.useState)(null),[x,p]=(0,s.useState)(null),[v,b]=(0,s.useState)(null),[y,j]=(0,s.useState)(null),[f,w]=(0,s.useState)(null),[S,N]=(0,s.useState)(!1),[k,C]=(0,s.useState)(!1),[D,F]=(0,s.useState)(!1),[_,A]=(0,s.useState)(null),[E,H]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{a(!0),r(null);try{var t;const a=await n.FH.get("/api/signatures/".concat(e));A(a.data.signature),m(a.data.document),h(null!==(t=a.data.signature)&&void 0!==t&&t.signerEmail?{email:a.data.signature.signerEmail}:null),p("/api/docs/".concat(a.data.document._id,"/download"))}catch(l){var s,i;r((null===(s=l.response)||void 0===s||null===(i=s.data)||void 0===i?void 0:i.message)||"Failed to load document.")}a(!1)})()},[e]);return t?(0,c.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}):o?(0,c.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,c.jsx)("div",{className:"bg-white p-8 rounded shadow text-red-600",children:o})}):D?(0,c.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,c.jsx)("div",{className:"bg-white p-8 rounded shadow text-green-600 text-xl font-semibold",children:"Thank you! Your signature has been submitted."})}):(0,c.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:[(0,c.jsx)(d.A,{open:S,onClose:()=>N(!1),onSave:(e,t)=>{if(j(e),w(t),N(!1),E){const a=200,s=100,i={id:"signature-".concat(Date.now()),x:E.x-a/2,y:E.y-s/2,page:E.page,width:a,height:s,image:e,type:t,pageDims:E.pageDims};b(i),H(null)}}}),(0,c.jsxs)("div",{className:"w-full max-w-3xl p-8 bg-white rounded-2xl shadow-md",children:[(0,c.jsx)("h1",{className:"text-2xl font-semibold text-indigo-600 mb-4",children:"Sign Document"}),(0,c.jsxs)("div",{className:"mb-2 text-gray-700",children:["Signer: ",(0,c.jsx)("span",{className:"font-mono",children:null===g||void 0===g?void 0:g.email})]}),(0,c.jsx)("div",{className:"mb-6 text-gray-500 text-sm",children:"Click on the document to place your signature."}),(0,c.jsx)("div",{className:"border rounded overflow-hidden mb-4",children:(0,c.jsx)(l.A,{file:x,onPageClick:(e,t,a,s)=>{if(!y)return H({x:t,y:a,page:e,pageDims:s}),void N(!0);const i={id:"signature-".concat(Date.now()),x:t-100,y:a-50,page:e,width:200,height:100,image:y,type:f,pageDims:s};b(i)},signatureFields:v?[v]:[],onUpdateField:b})}),(0,c.jsx)("button",{className:"mt-4 bg-indigo-600 text-white px-6 py-2 rounded hover:bg-indigo-700 disabled:opacity-50",onClick:async()=>{if(v){C(!0),r(null);try{await n.FH.put("/api/signatures/".concat(e),{signatureData:v,signatureType:f}),F(!0)}catch(s){var t,a;r((null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to submit signature.")}C(!1)}},disabled:!v||k,children:k?"Submitting...":"Submit Signature"}),(0,c.jsx)("button",{className:"mt-4 ml-4 bg-rose-600 text-white px-6 py-2 rounded hover:bg-rose-700 disabled:opacity-50",onClick:async()=>{C(!0),r(null);try{await n.FH.post("/api/signatures/".concat(e,"/reject")),F(!0)}catch(s){var t,a;r((null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to reject signature.")}C(!1)},disabled:k,children:"Reject"}),!y&&(0,c.jsxs)("div",{className:"mt-4 text-sm text-gray-500",children:["Please add your signature to continue.",(0,c.jsx)("button",{className:"ml-2 text-indigo-600 underline",onClick:()=>N(!0),children:"Add Signature"})]})]})]})}}}]);
//# sourceMappingURL=820.cfdd2ba1.chunk.js.map