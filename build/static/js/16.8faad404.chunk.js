/*! For license information please see 16.8faad404.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkdoc_sign_client=self.webpackChunkdoc_sign_client||[]).push([[16],{956:(e,t,a)=>{a.d(t,{A:()=>p});var i=a(5043),n=a(3216),s=a(5475),r=a(9798),o=a(2894),l=a(9445),d=a(2043),c=a(7784);const u=(0,c.A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),m=(0,c.A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),g=(0,c.A)("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]]);var h=a(1089),x=a(579);const p=()=>{var e,t,a,c;const{user:p,logout:f}=(0,r.As)(),b=(0,n.Zp)(),v=(0,n.zy)(),{toast:y}=(0,l.dj)(),[j,w]=(0,i.useState)(!1),[N,k]=(0,i.useState)(!1),D=async()=>{k(!0);try{await f(),y({title:"Logged out",description:"You have been successfully logged out.",variant:"success"}),b("/login",{replace:!0,state:{from:v}})}catch(e){console.error("Logout error:",e),y({title:"Error",description:"Failed to log out. Please try again.",variant:"error"})}finally{k(!1)}};if(["/login","/register","/forgot-password","/reset-password"].includes(v.pathname))return null;const F=[{to:"/dashboard",label:"Dashboard"},{to:"/upload",label:"Upload"},{to:"/templates",label:"Templates"}];return(0,x.jsxs)("header",{className:"sticky top-0 z-40 w-full border-b bg-white/95 backdrop-blur supports-[backdrop-filter]:bg-white/60",children:[(0,x.jsxs)("div",{className:"container flex h-16 items-center justify-between px-4 sm:px-6 lg:px-8",children:[(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsxs)(s.N_,{to:"/",className:"flex items-center space-x-2",children:[(0,x.jsx)("img",{src:"/logo.svg",alt:"Logo",className:"h-8 w-8"}),(0,x.jsx)("span",{className:"text-xl font-bold text-primary-600",children:"DocSign"})]}),(0,x.jsx)("nav",{className:"hidden md:flex md:ml-10 md:space-x-6",children:F.map(e=>(0,x.jsx)(s.N_,{to:e.to,className:(0,h.cn)("text-sm font-medium transition-colors hover:text-primary-600",v.pathname===e.to?"text-primary-600":"text-gray-700"),children:e.label},e.to))})]}),(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[p?(0,x.jsxs)("div",{className:"hidden md:flex items-center gap-4",children:[(0,x.jsx)(o.$,{variant:"ghost",size:"sm",onClick:D,disabled:N,leftIcon:N?(0,x.jsx)(d.A,{}):(0,x.jsx)(u,{}),children:N?"Logging out...":"Logout"}),(0,x.jsx)("div",{className:"h-8 w-px bg-gray-200"}),(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)("div",{className:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center text-primary-600 font-medium",children:(null===(e=p.name)||void 0===e?void 0:e.charAt(0))||(null===(t=p.email)||void 0===t?void 0:t.charAt(0).toUpperCase())}),(0,x.jsx)("span",{className:"text-sm font-medium text-gray-700 hidden sm:inline",children:p.name||p.email})]})]}):(0,x.jsxs)("div",{className:"hidden md:flex items-center gap-2",children:[(0,x.jsx)(o.$,{variant:"ghost",size:"sm",onClick:()=>b("/login"),children:"Login"}),(0,x.jsx)(o.$,{size:"sm",onClick:()=>b("/register"),children:"Get Started"})]}),(0,x.jsx)(o.$,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>w(!j),"aria-label":j?"Close menu":"Open menu",children:(()=>{const e=j?(0,x.jsx)(m,{className:"h-5 w-5"}):(0,x.jsx)(g,{className:"h-5 w-5"});if(!i.isValidElement(e))throw new Error("[Header] Mobile menu icon must be a valid React element.");return e})()})]})]}),j&&(0,x.jsx)("div",{className:"md:hidden",children:(0,x.jsxs)("div",{className:"space-y-1 px-2 pb-3 pt-2",children:[F.map(e=>(0,x.jsx)(s.N_,{to:e.to,className:(0,h.cn)("block rounded-md px-3 py-2 text-base font-medium",v.pathname===e.to?"bg-primary-50 text-primary-600":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"),onClick:()=>w(!1),children:e.label},e.to)),p?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"border-t border-gray-200 my-2"}),(0,x.jsxs)("div",{className:"flex items-center px-3 py-2",children:[(0,x.jsx)("div",{className:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center text-primary-600 font-medium mr-2",children:(null===(a=p.name)||void 0===a?void 0:a.charAt(0))||(null===(c=p.email)||void 0===c?void 0:c.charAt(0).toUpperCase())}),(0,x.jsx)("span",{className:"text-sm font-medium text-gray-700",children:p.name||p.email})]}),(0,x.jsx)("button",{onClick:D,disabled:N,className:"w-full text-left px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:N?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{className:"h-4 w-4 border-2 border-gray-400 border-t-primary-500 rounded-full animate-spin"}),"Logging out..."]}):"Logout"})]}):(0,x.jsxs)("div",{className:"pt-4 pb-2 space-y-2",children:[(0,x.jsx)(o.$,{className:"w-full",onClick:()=>{w(!1),b("/login")},children:"Login"}),(0,x.jsx)(o.$,{variant:"outline",className:"w-full",onClick:()=>{w(!1),b("/register")},children:"Get Started"})]})]})})]})}},1016:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u});var i=a(2555),n=a(5043),s=a(3216),r=a(9798),o=a(8072),l=a(956),d=a(4122);var c=a(579);const u=()=>{const{id:e}=(0,s.g)(),{token:t,user:a}=(0,r.As)(),[u,m]=(0,n.useState)(null),[g,h]=(0,n.useState)(null),[x,p]=(0,n.useState)(!1),[f,b]=(0,n.useState)(""),[v,y]=(0,n.useState)([]),[j,w]=(0,n.useState)(!1),[N,k]=(0,n.useState)(null),[D,F]=(0,n.useState)(null),[S,A]=(0,n.useState)({width:900,height:1200}),[C,E]=(0,n.useState)(1),[L,z]=(0,n.useState)(!1),[I,M]=(0,n.useState)(""),[P,R]=(0,n.useState)(!1),[U,_]=(0,n.useState)(""),[V,T]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(!e)return;p(!0),b(""),h(null),y([]);(async()=>{try{const t=await r.FH.get("/api/docs/".concat(e));h(t.data.document);const a=(t.data.document.signers||[]).filter(e=>e.signatureData&&e.signatureData.image).map((e,t)=>({id:e._id||t,page:e.signatureData.page||1,x:e.signatureData.x||50,y:e.signatureData.y||50,width:e.signatureData.width||180,height:e.signatureData.height||60,rotation:e.signatureData.rotation||0,signature:{data:e.signatureData.image,type:e.signatureData.type},signerEmail:e.email}));y(a)}catch(i){var t,a;b((null===(t=i.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to load document.")}finally{p(!1)}})()},[e,t]),(0,n.useEffect)(()=>((async()=>{if(g)try{p(!0),b("");const e=localStorage.getItem("token"),t=await r.FH.get("/api/docs/".concat(g._id,"/download"),{responseType:"blob",headers:{Authorization:"Bearer ".concat(e)}}),a=window.URL.createObjectURL(t.data);T(a)}catch(a){var e,t;b((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to load PDF.")}finally{p(!1)}})(),()=>{V&&window.URL.revokeObjectURL(V)}),[g]);const H=v.find(e=>e.id===D);return(0,c.jsxs)("div",{className:"flex flex-col h-screen min-h-0 w-full",children:[(0,c.jsx)(l.A,{}),(0,c.jsxs)("div",{className:"h-12 flex items-center justify-center bg-gray-50 border-b border-gray-200 z-10",children:[(0,c.jsx)("button",{className:"px-3 py-2 bg-gray-200 rounded disabled:opacity-50 font-semibold min-w-[44px] min-h-[36px] focus:outline-none focus:ring-2 focus:ring-indigo-400 mx-1",onClick:()=>E(e=>Math.max(1,e-1)),disabled:C<=1,"aria-label":"Previous page",title:"Previous page",tabIndex:0,children:"Previous"}),(0,c.jsxs)("span",{className:"text-gray-700 font-medium mx-2","aria-live":"polite",children:["Page ",C]}),(0,c.jsx)("button",{className:"px-3 py-2 bg-gray-200 rounded disabled:opacity-50 font-semibold min-w-[44px] min-h-[36px] focus:outline-none focus:ring-2 focus:ring-indigo-400 mx-1",onClick:()=>E(e=>e+1),disabled:!1,"aria-label":"Next page",title:"Next page",tabIndex:0,children:"Next"})]}),(0,c.jsx)("div",{className:"flex-1 min-h-0 overflow-auto flex justify-center items-start bg-gray-50",children:(0,c.jsxs)("div",{className:"w-full max-w-5xl flex flex-col items-center relative m-auto",children:[(0,c.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Document Viewer"}),x&&(0,c.jsx)("div",{className:"text-gray-500",children:"Loading document..."}),f&&(0,c.jsx)("div",{className:"text-red-500",children:f}),I&&(0,c.jsx)("div",{className:"text-red-500",children:I}),U&&(0,c.jsx)("div",{className:"text-red-500",children:U}),V&&!x&&!f&&(0,c.jsx)(o.A,{file:V,pageNumber:C,signatureFields:v,onPageClick:N?async(t,i,n,s)=>{if(N&&g){z(!0),M("");try{const o=function(e,t,a){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return{x:e/i,y:a-t/i}}(i,n,s.height,1);await r.FH.post("/api/signatures/self-sign",{documentId:g._id,signerEmail:a.email,signerName:a.firstName+" "+a.lastName,signatureData:N.data,signatureType:N.type,position:{page:t,x:o.x,y:o.y,width:180,height:60,rotation:0,image:N.data,type:N.type}});const l=await r.FH.get("/api/docs/".concat(e));h(l.data.document);const d=(l.data.document.signers||[]).filter(e=>e.signatureData&&e.signatureData.image).map((e,t)=>({id:e._id||t,page:e.signatureData.page||1,x:e.signatureData.x||50,y:e.signatureData.y||50,width:e.signatureData.width||180,height:e.signatureData.height||60,rotation:e.signatureData.rotation||0,signature:{data:e.signatureData.image,type:e.signatureData.type},signerEmail:e.email}));y(d),k(null),w(!1)}catch(d){var o,l;M((null===(o=d.response)||void 0===o||null===(l=o.data)||void 0===l?void 0:l.message)||"Failed to save signature.")}finally{z(!1)}}}:void 0,onUpdateField:(e,t)=>{y(a=>a.map(a=>a.id===e?(0,i.A)((0,i.A)({},a),t):a))},onRemoveField:e=>{y(t=>t.filter(t=>t.id!==e)),F(null)},onFieldSelect:e=>{F(e)},selectedFieldId:D,onPageChange:E,initialPage:C,pageDims:S}),!V&&!x&&!f&&(0,c.jsx)("div",{className:"text-gray-500",children:"No PDF loaded"}),g&&"completed"!==g.status&&(0,c.jsx)("button",{className:"mt-6 px-6 py-3 bg-green-600 text-white rounded-xl font-semibold shadow hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-400 disabled:opacity-50",onClick:async()=>{if(g){R(!0),_("");try{const e=await r.FH.post("/api/signatures/finalize/".concat(g._id),{},{responseType:"blob"}),t=window.URL.createObjectURL(new Blob([e.data],{type:"application/pdf"})),a=document.createElement("a");a.href=t,a.setAttribute("download","".concat(g.originalName||"signed-document",".pdf")),document.body.appendChild(a),a.click(),a.parentNode.removeChild(a),window.URL.revokeObjectURL(t)}catch(a){var e,t;_((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to finalize and download PDF.")}finally{R(!1)}}},disabled:P,"aria-label":"Finalize and download signed PDF",children:P?"Finalizing...":"Finalize & Download Signed PDF"}),(0,c.jsx)("button",{className:"fixed bottom-8 right-8 z-40 bg-indigo-600 text-white rounded-full shadow-lg p-4 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-400",onClick:()=>w(!0),"aria-label":"Add Signature",disabled:L,children:(0,c.jsx)("span",{className:"text-2xl font-bold",children:"+"})}),(0,c.jsx)(d.A,{open:j,onClose:()=>{w(!1),k(null)},onSave:(e,t)=>{k({data:e,type:t}),w(!1)}}),H&&(0,c.jsxs)("div",{className:"fixed bottom-8 left-8 bg-white rounded shadow-lg px-4 py-2 text-gray-700 z-40",children:[(0,c.jsx)("div",{className:"font-semibold",children:"Signature Coordinates"}),(0,c.jsxs)("div",{children:["Page: ",H.page]}),(0,c.jsxs)("div",{children:["X: ",Math.round(H.x)]}),(0,c.jsxs)("div",{children:["Y: ",Math.round(H.y)]}),(0,c.jsxs)("div",{children:["Width: ",Math.round(H.width)]}),(0,c.jsxs)("div",{children:["Height: ",Math.round(H.height)]})]})]})})]})}},1089:(e,t,a)=>{a.d(t,{cn:()=>s});var i=a(8387),n=a(5667);function s(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.QP)((0,i.$)(t))}},2894:(e,t,a)=>{a.d(t,{$:()=>m});var i=a(2555),n=a(3986),s=a(5043),r=a(2656),o=a(1089),l=a(2043),d=a(579);const c=["className","variant","size","isLoading","loadingText","leftIcon","rightIcon","children"],u=(0,r.F)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"underline-offset-4 hover:underline text-primary"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),m=s.forwardRef((e,t)=>{let{className:a,variant:r,size:m,isLoading:g=!1,loadingText:h,leftIcon:x,rightIcon:p,children:f}=e,b=(0,n.A)(e,c);if(x&&!s.isValidElement(x))throw new Error("[Button] leftIcon must be a valid React element (JSX), not a component or object. You likely wrote leftIcon={MenuIcon} instead of leftIcon={<MenuIcon />}.");if(p&&!s.isValidElement(p))throw new Error("[Button] rightIcon must be a valid React element (JSX), not a component or object. You likely wrote rightIcon={MenuIcon} instead of rightIcon={<MenuIcon />}.");if("function"===typeof f||"object"===typeof f&&!Array.isArray(f)&&!s.isValidElement(f)&&null!==f)throw new Error("[Button] children must be valid React nodes (JSX, string, number, or array of these). You likely passed a component or object.");const v=s.isValidElement(x)?s.cloneElement(x,{className:(0,o.cn)("mr-2 h-4 w-4",x.props.className)}):null,y=s.isValidElement(p)?s.cloneElement(p,{className:(0,o.cn)("ml-2 h-4 w-4",p.props.className)}):null;return(0,d.jsx)("button",(0,i.A)((0,i.A)({className:(0,o.cn)(u({variant:r,size:m,className:a})),ref:t,disabled:g,role:"button","aria-label":b["aria-label"]||void 0},b),{},{children:g?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(l.A,{className:"animate-spin -ml-1 mr-2 h-4 w-4"}),h||"Loading..."]}):(0,d.jsxs)(d.Fragment,{children:[v,f&&s.Children.map(f,(e,t)=>s.isValidElement(e)?s.cloneElement(e,{key:t}):e),y]})}))});m.displayName="Button"},9445:(e,t,a)=>{a.d(t,{dj:()=>g});var i=a(2555),n=a(3986),s=a(5043),r=a(2656),o=a(1089),l=a(579);const d=["className","variant"],c=s.createContext({toast:()=>{},removeToast:()=>{}}),u=(0,r.F)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all",{variants:{variant:{default:"border bg-background text-foreground",destructive:"border-destructive bg-destructive text-destructive-foreground",success:"border-green-500 bg-green-50 text-green-900",warning:"border-amber-500 bg-amber-50 text-amber-900",info:"border-blue-500 bg-blue-50 text-blue-900"}},defaultVariants:{variant:"default"}}),m=s.forwardRef((e,t)=>{let{className:a,variant:s}=e,r=(0,n.A)(e,d);return(0,l.jsx)("div",(0,i.A)({ref:t,className:(0,o.cn)(u({variant:s}),a)},r))});m.displayName="Toast";const g=()=>{const e=s.useContext(c);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}}}]);
//# sourceMappingURL=16.8faad404.chunk.js.map